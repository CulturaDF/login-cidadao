{% extends "PROCERGSLoginCidadaoCoreBundle::base.loggedIn.html.twig" %}


{% block title %}{{ 'Change password' | trans }} | {{ parent() }}{% endblock title %}

{% block content %}
    <div id="profile-change-password" class="content clearfix">
        <h1 class="visible-xs">{%trans%}Change password{%endtrans%}</h1>


        {% trans_default_domain 'FOSUserBundle' %}

        {{ form_start(form, {'action': path('fos_user_change_password'), 'attr': {'role':'form', 'class':'lc_change_password'}}) }}
        {{ form_errors(form) }}
        <div class="form-content">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h2 class="panel-title">{{ 'Change Password' | trans }}</h2>
                </div>
                <div class="panel-body">
                    <div class="row clearfix">
                        <div class="col-md-12">
                            {% if form.current_password is defined %}
                                {{ form_row(form.current_password) }}
                            {% endif %}

                            {{ form_row(form.plainPassword) }}

                        </div>

                        {% for type, messages in app.session.flashbag.all() %}
                            {% for message in messages %}
                                <div class="col-md-12">
                                    <div class="text-center bg-success flash-{{ type }}">
                                        {{ message }}
                                    </div>
                                </div>
                            {% endfor %}
                        {% endfor %}
                    </div>
                </div>
                <div class="panel-footer text-right">
                    <input class="btn btn-success btn-sm" type="submit" value="{{ 'change_password.submit'|trans }}" />
                </div>
            </div>
            {{ form_end(form) }}

            {% if app.security.isGranted('FEATURE_2FACTOR_AUTH') %}
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h2 class="panel-title">{{ 'Two-Factor Authentication' | trans }}</h2>
                    </div>
                    <div class="panel-body">
                        {% if app.user.isTwoFactorAuthenticationEnabled %}
                            On
                        {% else %}
                            <p>{% trans %}Two-Factor Authentication is <strong>disabled</strong>. To enhance the security level of your account, click Enable. {% endtrans %}</p>
                            <p><a href="{{ path("2fa_enable") }}" class="btn btn-success">{{ 'Enable' | trans }}</a></p>
                            <p>{{ 'By enabling Two-Factor Authentication you add a very strong layer of security to your account because access will only be granted after typing a code generated by your smartphone.' | trans }}</p>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        </div>


    </div>
{% endblock %}
