{% extends 'PROCERGSLoginCidadaoCoreBundle:Admin:base.html.twig' %}
{% block content %}
<div id="profile-edit" class="content clearfix">
    <h1>{{ 'Service'|trans }}</h1>
    <div class="form-content">
        {% form_theme form 'PROCERGSLoginCidadaoCoreBundle::Form/fields.html.twig' %}
        {{ form_start(form, {'attr' : {'role' : 'form'}}) }} 
        {{ form_errors(form) }}
        <div class="row clearfix">
            <div class="col-md-7">
                {{ form_row(form.name) }}
                {{ form_row(form.description) }}
                {{ form_row(form.siteUrl) }}
                {{ form_row(form.redirectUris) }}
                {{ form_row(form.landingPageUrl) }}
                {{ form_row(form.termsOfUseUrl) }}
                {{ form_row(form.published) }}
                {{ form_row(form.visible) }}
                {{ form_row(form.publicId) }}
                {{ form_row(form.secret) }}
            </div>
            <div class="col-md-5">
                {% if client is defined and client.getPictureWebPath != '' %}
                    <img src="/{{ client.getPictureWebPath }}"/>
                {% else %}
					{% image '@PROCERGSLoginCidadaoCoreBundle/Resources/public/images/userav.png' %}
					<img src="{{ asset_url }}"/>
					{% endimage %}
                {% endif %}

               <div class="file-upload text-center">
                    <button type="button" class="btn btn-success btn-upload">{% trans %}Upload another picture{% endtrans %}</button>
                    <div class="file-name"></div>
                    {{ form_widget(form.pictureFile) }}
                </div>
            </div>
        </div>
        <div class="form-bar text-right">
            <input class='btn btn-success' type="submit" value="{{ 'Send'|trans }}" />
        </div>
        {{ form_end(form) }}
    </div>
</div>
{% endblock %}

{% block javascripts %} 
{{ parent() }}
<script type="text/javascript">
    function CollectionHolder(id) {
        var self = this;
        var holderId = id;
        var holder = $('#'+holderId);

        var addTagLink = $('<a href="#" class="add_link_'+holderId+'">Add</a>');
        var newLinkLi = $('<div></div>').append(addTagLink);
        holder.data('index', holder.find(':input').length);

        addTagLink.on('click', function(e) {
            e.preventDefault();
            self.addTagForm(holder, newLinkLi);
        });

        holder.append(newLinkLi);

        this.addTagForm = function (collectionHolder, newLinkLi) {
            var prototype = collectionHolder.data('prototype');
            var index = collectionHolder.data('index');
            var newForm = prototype.replace(/__name__label__/g, $('label[for='+collectionHolder.prop('id')+']').text()).replace(/__name__/g, index);
            collectionHolder.data('index', index + 1);
            newLinkLi.before(newForm);
        }
    }

    $(function() {
        $.each(['{{ form.allowedScopes.vars.id }}', '{{ form.allowedGrantTypes.vars.id }}'],function(idx,val){new CollectionHolder(val);});
    })
</script>
{% endblock %}