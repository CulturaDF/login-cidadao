{% extends "PROCERGSLoginCidadaoCoreBundle::base.loggedIn.html.twig" %}

{% block content %}
<div class="content notifications-broadcast-preview">
  <h2>{{ 'Notification Broadcast Preview' | trans }}</h2>
  <div class="panel panel-default">
    <div class="panel-body">

    <form method="POST">
      <h3>{{ 'Parameters' | trans }}</h3>
      <ul class="list-group">
      {% for placeholder in placeholders %}
        <li class="list-group-item placeholder">
          <span class="label" data-placeholder="{{ placeholder.name }}">{{ placeholder.name }}</span>
          <input type="text" value="{{ placeholder.default }}" class="pull-right value" name="placeholder[{{ placeholder.id }}]">
        </li>
      {% endfor %}
      </ul>
      <button type="button" class="btn btn-primary" id="btn-preview">Preview</button>


      <h4>{{ 'Template' | trans }}</h4>
      <div class="well" id="notification-preview">{{ template | raw}}</div>
      <div class="hidden" id="hidden-template">{{ template | raw}}</div>

      <h4>{{ 'Sending for...' | trans }} <span class="badge">{{ broadcast.receivers|length }}</span></h4>
      <ul class="list-group">
        {% for receiver in broadcast.receivers|slice(0,5) %}
          <li class="list-group-item">{{ receiver.email }}</li>
        {% endfor %}
      </ul>

      <div class="form-bar text-right">
        <button type="button" class="btn btn-danger pull-left">{{ 'Edit' | trans }}</button>
        <input class="btn btn-success" type="submit" value="Enviar">
      </div>
    </form>

    </div>
  </div>
</div>
{% endblock content %}

{% block stylesheets %}
    {{ parent() }}
    {% stylesheets '@PROCERGSLoginCidadaoNotificationBundle/Resources/public/css/broadcast.css' filter='cssrewrite' filter='?uglifycss' %}
    <link rel="stylesheet" href="{{ asset_url }}" />
    {% endstylesheets %}
{% endblock stylesheets %}

{% block javascripts %}
    {{ parent() }}
    {% javascripts
        '@PROCERGSLoginCidadaoNotificationBundle/Resources/public/js/jquery.ba-replacetext.js'
        '@PROCERGSLoginCidadaoNotificationBundle/Resources/public/js/broadcast.js'
        filter='?uglifyjs2'
    %}
        <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
{% endblock javascripts %}